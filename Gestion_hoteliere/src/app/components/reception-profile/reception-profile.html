<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ROYELLAS HOTEL - Profil</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="profile-container">
  <div class="sidebar">
    <div class="logo-section">
      <div class="logo">
        <i class="fas fa-crown"></i>
        <span>ROYELLAS <span class="hotel-name">HOTEL</span></span>
      </div>
      <p class="welcome-text">Welcome Back,</p> <div class="user-details"><h3>{{user.nom}} {{user.prenom}}</h3></div>
    </div>

    <div class="nav-menu">
      <div class="nav-item"
           [class.active]="activeSection === 'profile'"
           (click)="showSection('profile')">
        <div class="nav-icon">
          <i class="fas fa-user"></i>
        </div>
        <span class="nav-text">Profil</span>
      </div>

      <div class="nav-section-title" (click)="toggleClients()">
        Clients
        <i class="fas fa-chevron-down" [class.rotate]="clientsOpen"></i>
      </div>

      <div class="nav-submenu" *ngIf="clientsOpen">
        <div class="nav-item"
             [class.active]="activeSection === 'checkin'"
             (click)="showSection('checkin')">
          <div class="nav-icon"><i class="fas fa-sign-in-alt"></i></div>
          <span class="nav-text">Check In</span>
        </div>

        <div class="nav-item"
             [class.active]="activeSection === 'checkout'"
             (click)="showSection('checkout')">
          <div class="nav-icon"><i class="fas fa-sign-out-alt"></i></div>
          <span class="nav-text">Check Out</span>
        </div>
      </div>


      <!-- Chambres Section -->
      <div class="nav-section-title" (click)="toggleRooms()">
        Rooms
        <i class="fas fa-chevron-down" [class.rotate]="roomsOpen"></i>
      </div>

      <div class="nav-submenu" *ngIf="roomsOpen">
        <div class="nav-item"
             [class.active]="activeSection === 'rooms'"
             (click)="showSection('rooms')">
          <div class="nav-icon"><i class="fas fa-bed"></i></div>
          <span class="nav-text">View Rooms</span>
        </div>
      </div>


      <div class="nav-item"
           [class.active]="activeSection === 'reservations'"
           (click)="showSection('reservations')">
        <div class="nav-icon">
          <i class="fas fa-user"></i>
        </div>
        <span class="nav-text">Reservations</span>
      </div>

      <div class="nav-item"
           [class.active]="activeSection === 'settings'"
           (click)="showSection('settings')">
        <div class="nav-icon">
          <i class="fas fa-cog"></i>
        </div>
        <span class="nav-text">Settings</span>
      </div>

      <div class="nav-item"
           [class.active]="activeSection === 'contact'"
           (click)="showSection('contact')">
        <div class="nav-icon">
          <i class="fas fa-phone"></i>
        </div>
        <span class="nav-text">Contact Us</span>
      </div>

      <div class="nav-item"
           [class.active]="activeSection === 'report'"
           (click)="showSection('report')">
        <div class="nav-icon">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <span class="nav-text">Signaler</span>
      </div>
    </div>

    <div class="sidebar-footer">

      <div class="sidebar-actions">
        <button class="nav-btn logout-btn" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Déconnexion</span>
        </button>
        <button class="nav-btn delete-btn" (click)="deleteAccount()">
          <i class="fas fa-trash-alt"></i>
          <span>Supprimer</span>
        </button>
      </div>
    </div>
  </div>

  <div class="main-content">
    <!-- Profile Section -->
    <div class="content-section profile-edit" *ngIf="activeSection === 'profile'">
      <div class="page-header">
        <h1><i class="fas fa-user-edit"></i> Modifier le Profil</h1>
        <p class="page-subtitle">Mettez à jour vos informations personnelles</p>
      </div>

      <form [formGroup]="profileForm" (ngSubmit)="updateProfile()" class="profile-form">
        <div class="form-header">
          <div class="form-avatar-section">
            <div class="avatar-info">
              <h3>{{user.nom}} {{user.prenom}}</h3>
              <p>{{profileForm.get('email')?.value}}</p>
              <p>
                You are the receptionist. You check each client when they enter the hotel (Check In) and when they leave (Check Out).
                You also review the status of the rooms they occupy and verify the reservation dates for every guest.
              </p>
            </div>
          </div>
        </div>

        <div class="form-content">
          <div class="form-section">
            <h3><i class="fas fa-id-card"></i> Informations Personnelles</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="nom">Nom *</label>
                <input type="text" id="nom" formControlName="nom" placeholder="Your LastName" readonly>
              </div>

              <div class="form-group">
                <label for="prenom">Prénom *</label>
                <input type="text" id="prenom" formControlName="prenom" placeholder="Your FirstName" readonly>
              </div>

              <div class="form-group">
                <label for="email">Email *</label>
                <input type="email" id="email" formControlName="email" placeholder="Your Email" readonly>
              </div>


              <div class="form-group">
                <label for="tel">Téléphone *</label>
                <input type="tel" id="tel" formControlName="tel" placeholder="06 XX XX XX XX">
              </div>
            </div>
          </div>

          <div class="form-section">
            <h3><i class="fas fa-info-circle"></i> Informations Additionnelles</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="dateNaissance">Date de naissance *</label>
                <input type="date" id="dateNaissance" formControlName="dateNaissance">
              </div>

              <div class="form-group">
                <label for="cne">CNE *</label>
                <input type="text" id="cne" formControlName="cne" placeholder="Votre CNE">
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" (click)="cancelEdit()">
              <i class="fas fa-times"></i> Annuler
            </button>
            <button type="submit" class="btn-primary">
              <i class="fas fa-save"></i> Enregistrer les modifications
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- Check In Section -->
    <div class="content-section" *ngIf="activeSection === 'checkin'">
      <div class="page-header">
        <h1><i class="fas fa-sign-in-alt"></i> Check In</h1>
        <p class="page-subtitle">List of clients currently in the hotel</p>
      </div>

      <div class="clients-table-container">
        <table class="clients-table">
          <thead>
          <tr>
            <th>#</th>
            <th>Nom</th>
            <th>Prénom</th>
            <th>Email</th>
            <th>Téléphone</th>
            <th>Date de réservation</th>
            <th>Check In</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>1</td>
            <td>Hassan</td>
            <td>El Fassi</td>
            <td>hassan.ef@example.com</td>
            <td>06 12 34 56 78</td>
            <td>2026-01-10</td>
            <td>09:00</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Leila</td>
            <td>Benziane</td>
            <td>leila.b@example.com</td>
            <td>06 87 65 43 21</td>
            <td>2026-01-11</td>
            <td>14:00</td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Check Out Section -->
    <div class="content-section" *ngIf="activeSection === 'checkout'">
      <div class="page-header">
        <h1><i class="fas fa-sign-out-alt"></i> Check Out</h1>
        <p class="page-subtitle">List of clients who have left the hotel</p>
      </div>

      <div class="clients-table-container">
        <table class="clients-table">
          <thead>
          <tr>
            <th>#</th>
            <th>Nom</th>
            <th>Prénom</th>
            <th>Email</th>
            <th>Téléphone</th>
            <th>Date de réservation</th>
            <th>Check Out</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>1</td>
            <td>Amine</td>
            <td>Karim</td>
            <td>amine.k@example.com</td>
            <td>06 22 33 44 55</td>
            <td>2026-01-08</td>
            <td>10:00</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Sofia</td>
            <td>Lahmar</td>
            <td>sofia.l@example.com</td>
            <td>06 99 88 77 66</td>
            <td>2026-01-09</td>
            <td>12:00</td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Rooms Section -->
    <div class="content-section" *ngIf="activeSection === 'rooms'">
      <div class="page-header">
        <h1><i class="fas fa-bed"></i> ALL Rooms</h1>
      </div>

      <div class="rooms-table-container">
        <table class="rooms-table">
          <thead>
          <tr>
            <th>#</th>
            <th>Picture</th>
            <th>Numéro</th>
            <th>Type</th>
            <th>Description</th>
            <th>Prix</th>
            <th>Status</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let room of rooms; let i = index">
            <td>{{ i + 1 }}</td>
            <td>
              <img [src]="'http://localhost:8093/uploads/' + room.image" alt="Room image" />
            </td>
            <td>{{ room.numero }}</td>
            <td>{{ room.type }}</td>
            <td>{{ room.description }}</td>
            <td>{{ room.prix }} MAD/NIGHT</td>
            <td>
             <span class="status" [ngClass]="{
            'available': room.etat === 'Disponible',
            'occupied': room.etat === 'Occupée',
            'maintenance': room.etat === 'Maintenance'
          }">
            {{ room.etat }}
          </span>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
      <!-- Rooms Analytics -->
      <div class="rooms-analytics">

        <div class="chart-card">
          <h3>Rooms by Status</h3>
          <canvas id="statusChart"></canvas>
        </div>

        <div class="chart-card">
          <h3>Price by Room Type</h3>
          <canvas id="priceChart"></canvas>
        </div>

      </div>

    </div>


    <div class="reservations-section" *ngIf="activeSection === 'reservations'">
      <div class="page-header">
        <h1>
          <i class="fas fa-calendar-check"></i> ALL Reservations
        </h1>
      </div>
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>Name Client</th>
          <th>Email Client</th>
          <th>CNI</th>
          <th>Room Number</th>
          <th>Type Room</th>
          <th>Date Début</th>
          <th>Date Fin</th>
          <th>Statut</th>
          <th>Total Prix</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let res of reservations">
          <td>{{ res.idReservation }}</td>

          <!-- Client info -->
          <td>{{ res.client?.nom || res.client_id }} {{ res.client?.prenom || '' }}</td>
          <td>{{ res.client?.email || 'N/A' }}</td>
          <td>{{ res.client?.cni }}</td>

          <!-- Room info -->
          <td>{{ res.chambre?.numero || res.chambre_id }}</td>
          <td>{{ res.chambre?.type || res.typeChambre }}</td>

          <td>{{ res.dateDebut | date:'dd/MM/yyyy' }}</td>
          <td>{{ res.dateFin | date:'dd/MM/yyyy' }}</td>

          <td [ngClass]="{
            'pending': res.statut === 'pending',
            'confirmed': res.statut === 'confirmed',
            'rejected': res.statut === 'rejected'
          }">{{ res.statut }}</td>

          <td>{{ res.totalPrix | number:'1.2-2' }} MAD</td>

          <td class="actions-cell">
            <button class="btn-confirm"
                    *ngIf="res.statut === 'pending'"
                    (click)="confirmReservation(res)">
              Confirmer
            </button>

            <button class="btn-reject"
                    *ngIf="res.statut === 'pending'"
                    (click)="rejectReservation(res)">
              Rejeter
            </button>

              <span *ngIf="res.statut === 'confirmed'" class="status-confirmed">
                ✔ Confirmed
              </span>

              <span *ngIf="res.statut === 'rejected'" class="status-rejected">
                ✖ Rejected
              </span>
          </td>

        </tr>
        </tbody>
      </table>
    </div>


    <!-- Settings Section -->
    <div class="content-section" *ngIf="activeSection === 'settings'">
      <div class="page-header">
        <h1><i class="fas fa-cog"></i> Paramètres</h1>
      </div>

      <div class="settings-container">
        <div class="settings-section">
          <h2><i class="fas fa-bell"></i> Préférences de Notifications</h2>
          <div class="settings-options">
            <div class="setting-item">
              <div class="setting-info">
                <h4>Notifications par email</h4>
                <p>Recevoir des notifications importantes par email</p>
              </div>
              <label class="switch">
                <input type="checkbox" [(ngModel)]="settings.emailNotifications">
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <h4>Notifications SMS</h4>
                <p>Recevoir des alertes importantes par SMS</p>
              </div>
              <label class="switch">
                <input type="checkbox" [(ngModel)]="settings.smsNotifications">
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h2><i class="fas fa-globe"></i> Langue et Région</h2>
          <div class="form-group">
            <label for="language">Langue</label>
            <select id="language" [(ngModel)]="settings.language" class="language-select">
              <option value="fr">Français</option>
              <option value="en">English</option>
              <option value="ar">العربية</option>
            </select>
          </div>
        </div>

        <div class="settings-section">
          <h2><i class="fas fa-lock"></i> Confidentialité</h2>
          <div class="settings-options">
            <div class="setting-item">
              <div class="setting-info">
                <h4>Profil public</h4>
                <p>Rendre votre profil visible aux autres utilisateurs</p>
              </div>
              <label class="switch">
                <input type="checkbox" [(ngModel)]="settings.publicProfile">
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Contact Section -->
    <div class="content-section" *ngIf="activeSection === 'contact'">
      <div class="page-header">
        <h1><i class="fas fa-phone"></i> Contact</h1>
      </div>

      <div class="contact-container">
        <div class="contact-info-section">
          <h2><i class="fas fa-info-circle"></i> Informations de Contact</h2>
          <div class="contact-cards">
            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="contact-content">
                <h3>Email</h3>
                <p>contact&#64;royellashotel.com</p>
                <small>Réponse sous 24h</small>
              </div>
            </div>

            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-phone"></i>
              </div>
              <div class="contact-content">
                <h3>Téléphone</h3>
                <p>+212 5 XX XX XX XX</p>
                <small>Lun-Ven: 9h-18h</small>
              </div>
            </div>

            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <div class="contact-content">
                <h3>Adresse</h3>
                <p>123 Avenue Mohammed V, Casablanca, Maroc</p>
                <small>Visites sur rendez-vous</small>
              </div>
            </div>
          </div>
        </div>

        <div class="contact-form-section">
          <h2><i class="fas fa-paper-plane"></i> Envoyer un Message</h2>
          <div class="contact-form">
            <div class="form-group">
              <label for="contactSubject">Sujet</label>
              <input type="text" id="contactSubject" placeholder="Objet de votre message">
            </div>
            <div class="form-group">
              <label for="contactMessage">Message</label>
              <textarea id="contactMessage" [(ngModel)]="contactMessage"
                        placeholder="Votre message..." rows="6"></textarea>
            </div>
            <button class="btn-primary send-btn" (click)="sendMessage()">
              <i class="fas fa-paper-plane"></i> Envoyer le Message
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Report Section -->
    <div class="content-section" *ngIf="activeSection === 'report'">
      <div class="page-header">
        <h1><i class="fas fa-exclamation-triangle"></i> Signaler un Problème</h1>
      </div>

      <div class="report-container">
        <div class="report-form">
          <div class="form-section">
            <h3><i class="fas fa-clipboard-list"></i> Détails du Problème</h3>
            <div class="form-group">
              <label for="reportType">Type de problème</label>
              <select id="reportType" [(ngModel)]="report.type">
                <option value="technical">Problème technique</option>
                <option value="bug">Bug</option>
                <option value="suggestion">Suggestion</option>
                <option value="other">Autre</option>
              </select>
            </div>

            <div class="form-group">
              <label for="reportSubject">Sujet</label>
              <input type="text" id="reportSubject" [(ngModel)]="report.subject"
                     placeholder="Décrivez brièvement le problème">
            </div>

            <div class="form-group">
              <label for="reportDescription">Description détaillée</label>
              <textarea id="reportDescription" [(ngModel)]="report.description"
                        placeholder="Décrivez le problème en détail..."
                        rows="6"></textarea>
            </div>

            <div class="form-group">
              <label for="reportScreenshot">Capture d'écran (optionnel)</label>
              <div class="file-upload">
                <label for="reportScreenshot" class="file-upload-label">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <span>Choisir un fichier</span>
                </label>
                <input id="reportScreenshot" type="file"
                       (change)="onScreenshotSelected($event)"
                       accept="image/*" hidden>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button class="btn-secondary">
              <i class="fas fa-times"></i> Annuler
            </button>
            <button class="btn-primary">
              <i class="fas fa-paper-plane"></i> Envoyer le Rapport
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Confirmation Modal -->
<div class="modal" *ngIf="showModal">
  <div class="modal-content">
    <div class="modal-icon">
      <i class="fas fa-exclamation-circle"></i>
    </div>
    <h2>Confirmation</h2>
    <p>{{modalMessage}}</p>
    <div class="modal-actions">
      <button class="btn-secondary" (click)="showModal = false">
        <i class="fas fa-times"></i> Annuler
      </button>
      <button class="btn-danger" (click)="confirmAction()">
        <i class="fas fa-check"></i> Confirmer
      </button>
    </div>
  </div>
</div>
</body>
</html>
