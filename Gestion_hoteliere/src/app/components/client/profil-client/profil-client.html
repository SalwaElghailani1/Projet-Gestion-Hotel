<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ROYELLAS HOTEL - Profil</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="profile-container">
  <div class="sidebar">
    <div class="logo-section">
      <div class="logo">
        <i class="fas fa-crown"></i>
        <span>ROYELLAS <span class="hotel-name">HOTEL</span></span>
      </div>
      <p class="welcome-text">Welcome Back,</p> <div class="user-details"><h3>{{user.nom}} {{user.prenom}}</h3></div>
    </div>

    <div class="nav-menu">
      <div class="nav-item"
           [class.active]="activeSection === 'profile'"
           (click)="showSection('profile')">
        <div class="nav-icon">
          <i class="fas fa-user"></i>
        </div>
        <span class="nav-text">Profil</span>
      </div>

      <div class="nav-item"
           [class.active]="activeSection === 'notifications'"
           (click)="showSection('notifications')">
        <div class="nav-icon">
          <i class="fas fa-bell"></i>
        </div>
        <span class="nav-text">Notifications</span>
      </div>

      <div class="nav-item"
           [class.active]="activeSection === 'settings'"
           (click)="showSection('settings')">
        <div class="nav-icon">
          <i class="fas fa-cog"></i>
        </div>
        <span class="nav-text">Paramètres</span>
      </div>

      <div class="nav-item"
           [class.active]="activeSection === 'contact'"
           (click)="showSection('contact')">
        <div class="nav-icon">
          <i class="fas fa-phone"></i>
        </div>
        <span class="nav-text">Contact</span>
      </div>

      <div class="nav-item"
           [class.active]="activeSection === 'report'"
           (click)="showSection('report')">
        <div class="nav-icon">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <span class="nav-text">Signaler</span>
      </div>
    </div>

    <div class="sidebar-footer">

      <div class="sidebar-actions">
        <button class="nav-btn logout-btn" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Déconnexion</span>
        </button>
        <button class="nav-btn delete-btn" (click)="deleteAccount()">
          <i class="fas fa-trash-alt"></i>
          <span>Supprimer</span>
        </button>
      </div>
    </div>
  </div>


  <div class="main-content">
    <!-- Profile Section -->
    <div class="content-section profile-edit" *ngIf="activeSection === 'profile'">
      <div class="page-header">
        <h1><i class="fas fa-user-edit"></i> Edit Profile</h1>
        <p class="page-subtitle">Update your personal information</p>
      </div>

      <div *ngIf="reservationMessage" class="reservation-alert">
        <i class="fas fa-info-circle"></i>
        <div class="alert-text">
          <h4>Reservation Pending</h4>
          <p>{{ reservationMessage }}</p>
        </div>
      </div>

      <form [formGroup]="profileForm" (ngSubmit)="updateProfile()" class="profile-form">
        <div class="form-header">
          <div class="form-avatar-section">
            <div class="current-avatar">
              <div class="avatar-icon" *ngIf="!imagePreview && !user.image">
                <i class="fas fa-user"></i>
              </div>

              <img *ngIf="imagePreview || user.photo_carte_identity"
                   [src]="imagePreview || user.photo_carte_identity"
                   alt="Profile">


              <div class="avatar-overlay">
                <label for="fileInput" class="change-photo-btn">
                  <i class="fas fa-camera"></i>
                  <span>Changer photo</span>
                </label>
                <input id="fileInput" type="file" (change)="onImageSelected($event)" accept="image/*" hidden>
              </div>
            </div>
            <div class="avatar-info">
              <h3>{{user.nom}} {{user.prenom}}</h3>
              <p *ngIf="user.created_at">
                Membre depuis {{ getMemberSince(user.created_at) }}
              </p>

            </div>
          </div>
        </div>

        <div class="form-content">
          <div class="form-section">
            <h3><i class="fas fa-id-card"></i> Informations Personnelles</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="nom">Nom *</label>
                <input type="text" id="nom" formControlName="nom" placeholder="Votre nom">
                <div class="error" *ngIf="profileForm.get('nom')?.invalid && profileForm.get('nom')?.touched">
                  Nom requis
                </div>
              </div>

              <div class="form-group">
                <label for="prenom">Prénom *</label>
                <input type="text" id="prenom" formControlName="prenom" placeholder="Votre prénom">
                <div class="error" *ngIf="profileForm.get('prenom')?.invalid && profileForm.get('prenom')?.touched">
                  Prénom requis
                </div>
              </div>

              <div class="form-group">
                <label for="email">Email *</label>
                <input type="email" id="email" formControlName="email" readonly>
                <div class="error" *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
                  Email invalide
                </div>
              </div>

              <div class="form-group">
                <label for="tel">Téléphone *</label>
                <input type="tel" id="tel" formControlName="tel" placeholder="06 XX XX XX XX">
              </div>
            </div>
          </div>

          <div class="form-section">
            <h3><i class="fas fa-info-circle"></i> Informations Additionnelles</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="dateNaissance">Date de naissance *</label>
                <input type="date" id="dateNaissance" formControlName="dateNaissance">
              </div>

              <div class="form-group">
                <label for="cni">CNI *</label>
                <input type="text" id="cni" formControlName="cni" placeholder="Votre CNI">
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" (click)="cancelEdit()">
              <i class="fas fa-times"></i> Cancel
            </button>
            <button type="submit" class="btn-primary" [disabled]="!profileForm.valid">
              <i class="fas fa-save"></i> Save Changes
            </button>
          </div>
        </div>
      </form>
    </div>

      <div class="content-section" *ngIf="activeSection === 'notifications'">
        <div class="page-header">
          <h1><i class="fas fa-bell"></i> Notifications</h1>
          <button class="mark-all-btn" (click)="markAllAsRead()">
            <i class="fas fa-check-double"></i> Tout marquer comme lu
          </button>
        </div>

        <div class="notifications-container">
          <div *ngFor="let notif of notifications"
               class="notification-item"
               [class.unread]="!notif.read">
            <div class="notification-icon-bg">
              <i [class]="notif.icon"></i>
            </div>
            <div class="notification-content">
              <div class="notification-header">
                <h3>{{notif.title}}</h3>
                <span class="notification-time">{{notif.time}}</span>
              </div>
              <p class="notification-message"
                               [ngClass]="{
                   'message-confirmed': notif.message.includes('confirmed'),
                   'message-rejected': notif.message.includes('rejected')
                 }">
                {{notif.message}}
              </p>

              <!-- Action selon status -->
              <div *ngIf="notif.message.includes('confirmed')" class="notif-action">
                <button class="btn-primary" (click)="goToPayment()">
                  Go to Payment
                </button>
              </div>

              <div *ngIf="notif.message.includes('rejected')" class="notif-action">
                <span class="rejected-text">Try Again</span>
              </div>
            </div>
            <div class="notification-actions">
              <button class="notification-action-btn" (click)="toggleRead(notif)"
                      [title]="notif.read ? 'Marquer comme non lu' : 'Marquer comme lu'">
                <i [class]="notif.read ? 'fas fa-envelope-open' : 'fas fa-envelope'"></i>
              </button>
            </div>
          </div>
        </div>
      </div>


    <!-- Settings Section -->
    <div class="content-section" *ngIf="activeSection === 'settings'">
      <div class="page-header">
        <h1><i class="fas fa-cog"></i> Paramètres</h1>
      </div>

      <div class="settings-container">
        <div class="settings-section">
          <h2><i class="fas fa-bell"></i> Préférences de Notifications</h2>
          <div class="settings-options">
            <div class="setting-item">
              <div class="setting-info">
                <h4>Notifications par email</h4>
                <p>Recevoir des notifications importantes par email</p>
              </div>
              <label class="switch">
                <input type="checkbox" [(ngModel)]="settings.emailNotifications">
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <h4>Notifications SMS</h4>
                <p>Recevoir des alertes importantes par SMS</p>
              </div>
              <label class="switch">
                <input type="checkbox" [(ngModel)]="settings.smsNotifications">
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h2><i class="fas fa-globe"></i> Langue et Région</h2>
          <div class="form-group">
            <label for="language">Langue</label>
            <select id="language" [(ngModel)]="settings.language" class="language-select">
              <option value="fr">Français</option>
              <option value="en">English</option>
              <option value="ar">العربية</option>
            </select>
          </div>
        </div>

        <div class="settings-section">
          <h2><i class="fas fa-lock"></i> Confidentialité</h2>
          <div class="settings-options">
            <div class="setting-item">
              <div class="setting-info">
                <h4>Profil public</h4>
                <p>Rendre votre profil visible aux autres utilisateurs</p>
              </div>
              <label class="switch">
                <input type="checkbox" [(ngModel)]="settings.publicProfile">
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Contact Section -->
    <div class="content-section" *ngIf="activeSection === 'contact'">
      <div class="page-header">
        <h1><i class="fas fa-phone"></i> Contact</h1>
      </div>

      <div class="contact-container">
        <div class="contact-info-section">
          <h2><i class="fas fa-info-circle"></i> Informations de Contact</h2>
          <div class="contact-cards">
            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="contact-content">
                <h3>Email</h3>
                <p>contact@royellashotel.com</p>
                <small>Réponse sous 24h</small>
              </div>
            </div>

            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-phone"></i>
              </div>
              <div class="contact-content">
                <h3>Téléphone</h3>
                <p>+212 5 XX XX XX XX</p>
                <small>Lun-Ven: 9h-18h</small>
              </div>
            </div>

            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <div class="contact-content">
                <h3>Adresse</h3>
                <p>123 Avenue Mohammed V, Casablanca, Maroc</p>
                <small>Visites sur rendez-vous</small>
              </div>
            </div>
          </div>
        </div>

        <div class="contact-form-section">
          <h2><i class="fas fa-paper-plane"></i> Envoyer un Message</h2>
          <div class="contact-form">
            <div class="form-group">
              <label for="contactSubject">Sujet</label>
              <input type="text" id="contactSubject" placeholder="Objet de votre message">
            </div>
            <div class="form-group">
              <label for="contactMessage">Message</label>
              <textarea id="contactMessage" [(ngModel)]="contactMessage"
                        placeholder="Votre message..." rows="6"></textarea>
            </div>
            <button class="btn-primary send-btn" (click)="sendMessage()">
              <i class="fas fa-paper-plane"></i> Envoyer le Message
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Report Section -->
    <div class="content-section" *ngIf="activeSection === 'report'">
      <div class="page-header">
        <h1><i class="fas fa-exclamation-triangle"></i> Signaler un Problème</h1>
      </div>

      <div class="report-container">
        <div class="report-form">
          <div class="form-section">
            <h3><i class="fas fa-clipboard-list"></i> Détails du Problème</h3>
            <div class="form-group">
              <label for="reportType">Type de problème</label>
              <select id="reportType" [(ngModel)]="report.type">
                <option value="technical">Problème technique</option>
                <option value="bug">Bug</option>
                <option value="suggestion">Suggestion</option>
                <option value="other">Autre</option>
              </select>
            </div>

            <div class="form-group">
              <label for="reportSubject">Sujet</label>
              <input type="text" id="reportSubject" [(ngModel)]="report.subject"
                     placeholder="Décrivez brièvement le problème">
            </div>

            <div class="form-group">
              <label for="reportDescription">Description détaillée</label>
              <textarea id="reportDescription" [(ngModel)]="report.description"
                        placeholder="Décrivez le problème en détail..."
                        rows="6"></textarea>
            </div>

            <div class="form-group">
              <label for="reportScreenshot">Capture d'écran (optionnel)</label>
              <div class="file-upload">
                <label for="reportScreenshot" class="file-upload-label">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <span>Choisir un fichier</span>
                </label>
                <input id="reportScreenshot" type="file"
                       (change)="onScreenshotSelected($event)"
                       accept="image/*" hidden>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button class="btn-secondary">
              <i class="fas fa-times"></i> Annuler
            </button>
            <button class="btn-primary" (click)="submitReport()">
              <i class="fas fa-paper-plane"></i> Envoyer le Rapport
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Confirmation Modal -->
<div class="modal" *ngIf="showModal">
  <div class="modal-content">
    <div class="modal-icon">
      <i class="fas fa-exclamation-circle"></i>
    </div>
    <h2>Confirmation</h2>
    <p>{{modalMessage}}</p>
    <div class="modal-actions">
      <button class="btn-secondary" (click)="showModal = false">
        <i class="fas fa-times"></i> Annuler
      </button>
      <button class="btn-danger" (click)="confirmAction()">
        <i class="fas fa-check"></i> Confirmer
      </button>
    </div>
  </div>
</div>
</body>
</html>
